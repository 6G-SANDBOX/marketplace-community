---
name: "[Testing] 6G-Sandbox bastion"
version: "20241125-1624"
publisher: Telefonica Innovacion Digital
description: |-
  This appliance installs the latest version of the bastion, the entrypoint of every Virtual Network, with additional services such as:
  - Technitium DNS
  - [route-manager-api](https://github.com/6G-SANDBOX/route-manager-api)
  - Wireguard VPN

  The Bastion has IPv4 routing enabled by default, with all private IPs forbidden by default, unless explictly specified.

  The image is based on an Ubuntu 22.04 cloud image with the OpenNebula [contextualization package](http://docs.opennebula.io/6.6/management_and_operations/references/kvm_contextualization.html).

  After deploying the appliance, check the status of the deployment in /etc/one-appliance/status. You chan check the appliance logs in /var/log/one-appliance/.

  **Note**: Remember to add a password variable in the template in order to have access to it, or make sure that your OpenNebula user has an SSH Public key preconfigured.

  **Note**: Remember to update the template in order to add a network after importing it.

short_description: 6G-Sandbox bastion for KVM
tags:
  - 6G-Sandbox
  - 6G-Library
  - bastion
  - ubuntu
format: qcow2
creation_time: "1721838167"
os-id: Ubuntu
os-release: 22.04 LTS
os-arch: x86_64
hypervisor: KVM
opennebula_version: >-
  6.2, 6.3, 6.4, 6.6, 6.8, 6.10
opennebula_template:
  context:
    network: 'YES'
    netcfg_type: "interfaces"
    set_hostname: "$NAME"
    ssh_public_key: "$USER[SSH_PUBLIC_KEY]"
    oneapp_bastion_dns_password:       "$ONEAPP_BASTION_DNS_PASSWORD"
    oneapp_bastion_dns_forwarders:     "$ONEAPP_BASTION_DNS_FORWARDERS"
    oneapp_bastion_dns_domain:         "$ONEAPP_BASTION_DNS_DOMAIN"
    oneapp_bastion_routemanager_token: "$ONEAPP_BASTION_ROUTEMANAGER_TOKEN"
    oneapp_bastion_routemanager_port:  "$ONEAPP_BASTION_ROUTEMANAGER_PORT"
  cpu: '2'
  vcpu: '2'
  graphics:
    listen: 0.0.0.0
    type: vnc
  hot_resize:
    cpu_hot_add_enabled: 'YES'
    memory_hot_add_enabled: 'YES'
  hypervisor: kvm
  memory: '2048'
  memory_unit_cost: 'MB'
  memory_resize_mode: 'BALLOONING'
  os:
    arch: x86_64
  logo: images/logos/ubuntu.png
  user_inputs:
    gnb_amf_address: "O|text|GNB_AMF_ADDRESS: gNB AMF IP Addresss| |"
    gnb_mcc:         "O|text|GNB_MCC: gNB Mobile Country Code value| |999"
    gnb_mnc:         "O|text|GNB_MNC: gNB Mobile Network Code value (2 or 3 digits)| |70"
    gnb_slices_sd:   "O|text|GNB_SLICES_SD: gNB SD of the supported S-NSSAI. Minimum length of 6. | |000001"
    gnb_slices_sst:  "O|number|GNB_SLICES_SST: gNB SST of the supported S-NSSAI| |1"
    gnb_tac:         "O|number|GNB_TAC: gNB Tracking Area Code| |1"
    oneke_vnf:       "O|text|ONEKE_VNF: If specified, gateway IP where the gNB will route the traffic in order to reach the `gnb_amf_address`| |"
    run_gnb:         "M|boolean|RUN_GNB: Whether to start the gNB service or not| |"
    run_ue:          "M|boolean|RUN_UE: Wether to start the UE service or not| |"
    ue_configured_nssai_sd:  "O|text|UE_CONFIGURED_NSSAI_SD: UE SD of the NSSAI configured by HPLMN. Minimum length of 6.| |000001"
    ue_configured_nssai_sst: "O|number|UE_CONFIGURED_NSSAI_SST: UE SST of the NSSAI configured by HPLMN| |1"
    ue_default_nssai_sd:     "O|text|UE_DEFAULT_NSSAI_SD: SD of the default Configured NSSAI. Minimum length of 6.| |000001"
    ue_default_nssai_sst:    "O|number|UE_DEFAULT_NSSAI_SST: SST of the default Configured NSSAI| |1"
    ue_gnbsearchlist:        "O|text|UE_GNBSEARCHLIST: UE comma separated list of gNB IP addresses for Radio Link Simulation| |"
    ue_key:         "O|text|UE_KEY: UE permanent subscription key| |465B5CE8B199B49FAA5F0A2EE238A6BC"
    ue_mcc:         "O|text|UE_MCC: UE Mobile Country Code value of HPLMN| |999"
    ue_mnc:         "O|text|UE_MNC: UE Mobile Network Code value of HPLMN (2 or 3 digits)| |70"
    ue_op:          "O|text|UE_OP: UE Operator code (OP or OPC)| |E8ED289DEBA952E4283B54E88E6183CA"
    ue_session_apn: "O|text|UE_SESSION_APN: UE APN of the initial PDU session to be stablished| |internet"
    ue_session_sd:  "O|text|UE_SESSION_SD: UE SD of the initial PDU session to be stablished. Minimum length of 6.| |000001"
    ue_session_sst: "O|number|UE_SESSION_SST: UE SST of the initial PDU session to be stablished| |1"
    ue_supi:        "O|text|UE_SUPI: UE IMSI number. IMSI = [MCC|MNC|MSISDN] (In total 15 digits)| |imsi-999700000000001"
    oneapp_bastion_dns_password:       "O|password|ONEAPP_BASTION_DNS_PASSWORD: For the Technitium DNS, admin user password.| |admin"
    oneapp_bastion_dns_forwarders:     "O|text|ONEAPP_BASTION_DNS_FORWARDERS: For the Technitium DNS, comma separated list of forwarders to be used by the DNS server.| |8.8.8.8, 1.1.1.1"
    oneapp_bastion_dns_domain:         "M|text|ONEAPP_BASTION_DNS_DOMAIN: For the Technitium DNS, domain name for creating the new zone."
    oneapp_bastion_routemanager_token: "O|password|ONEAPP_BASTION_ROUTEMANAGER_TOKEN: For the route-manager-api, token to authenticate to the API. If not provided, a new one will be generated at instanciate time with `openssl rand -base64 32` | |"
    oneapp_bastion_routemanager_port:  "O|number|ONEAPP_ROUTEMANAGER_PORT: For the route-manager-api, TCP port where the API service is be exposed| |8172"
logo: sandbox.png
images:
  - name: "[Testing] 6G-Sandbox bastion"
    url: >-
      https://rawtest.mobilesandbox.cloud:9443/service_bastion.qcow2
    type: OS
    dev_prefix: vd
    driver: qcow2
    size: "10737418240"
    checksum:
      md5: "16da388980a2e575c09cf3f4a2a40180"
      sha256: "79477b99b9d7e7ef4158cf17614d1e626c166fe0da8a1d5d5a766a40facfda18"
